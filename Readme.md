Алгоритм работы программы:

![Алгоритм в графическом виде](graph.png)

Спасибо за внимание!